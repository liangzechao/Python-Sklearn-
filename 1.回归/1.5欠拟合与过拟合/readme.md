## 1.基本概念

为了解决欠拟合的情 经常要提高线性的次数建立模型拟合曲线， 次数过高会导致过拟合，次数不够会欠拟合。

在建立高次函数时候，要利用多项式特征生成器生成训练数据。

下面模拟了一个预测蛋糕价格的从欠拟合到过拟合的过程


在做线性回归预测时候，为了提高模型的泛化能力，经常采用多次线性函数建立模型

- f = k*x + b   一次函数
- f = a*x^2 + b*x + w  二次函数
- f = a*x^3 + b*x^2 + c*x + w  三次函数

泛化：
    对未训练过的数据样本进行预测。
    
欠拟合:
    由于对训练样本的拟合程度不够，导致模型的泛化能力不足。

过拟合：
    训练样本拟合非常好，并且学习到了不希望学习到的特征，导致模型的泛化能力不足。
    

在建立超过一次函数的线性回归模型之前，要对默认特征生成多项式特征再输入给模型
```
poly2 = PolynomialFeatures(degree=2)    # 2次多项式特征生成器
x_train_poly2 = poly2.fit_transform(x_train)
```

下面模拟 根据蛋糕的直径大小 预测蛋糕价格

## [2.代码](https://github.com/liangzechao/PythonSklearnML/blob/master/1.回归/1.5欠拟合与过拟合/fitting.py)

## 3.结果

- 一次线性函数拟合曲线的结果，是欠拟合的情况：

![](https://images2018.cnblogs.com/blog/1157201/201805/1157201-20180501091624955-290839122.png)

- 二次线性回归模型拟合的曲线,拟合程度明显比1次线性拟合的要好

![](https://images2018.cnblogs.com/blog/1157201/201805/1157201-20180501092959061-1269405559.png)

- 四次线性模型预测准确率为百分之百， 但是看一下拟合曲线，明显存在不合逻辑的预测曲线，在样本点之外的情况，可能预测的非常不准确，这种情况为过拟合

![](https://images2018.cnblogs.com/blog/1157201/201805/1157201-20180501093408361-2062812092.png)

会发现，二次模型在预测集合上表现最好，四次模型表现反而不好！

这就是由于对训练数据学习的太过分，学习到了不重要的东西，反而导致预测不准确。